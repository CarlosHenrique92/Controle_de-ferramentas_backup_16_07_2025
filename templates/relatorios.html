<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>RelatÃ³rios de Ferramentas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">
    <div class="container">
        <h2 class="mb-4">ðŸ“Š RelatÃ³rios de Ferramentas</h2>
        <a href="/relatorio_estoque" class="btn btn-outline-success mb-3">ðŸ“¦ Ver RelatÃ³rio de Estoque</a>
        <a href="/exportar_excel_projetos" class="btn btn-outline-success mb-3">ðŸ“¦ Exportar Projetos para Excel</a>

        <!-- FormulÃ¡rio de Filtro -->
        <form method="POST" class="row g-2 mb-4">
            <div class="col-md-4">
                <select name="nome" class="form-select">
                    <option value="">-- Filtrar por Ferramenta --</option>
                    {% for nome in nomes_ferramentas %}
                        <option value="{{ nome }}">{{ nome }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4">
                <select name="tecnico" class="form-select">
                    <option value="">-- Filtrar por TÃ©cnico --</option>
                    {% for tecnico in tecnicos %}
                        <option value="{{ tecnico }}">{{ tecnico }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4">
                <select name="local" class="form-select">
                    <option value="">-- Filtrar por Projeto --</option>
                    {% for projeto in locais %}
                        <option value="{{ projeto }}">{{ projeto }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2 mt-2">
                <button class="btn btn-primary w-100">Filtrar</button>
            </div>
            <div class="col-md-2 mt-2">
                <a href="/" class="btn btn-secondary w-100">Voltar</a>
            </div>
        </form>

        <!-- Tabela de Resultados -->
        {% if ferramentas %}
        <table class="table table-bordered table-hover">
            <thead class="table-info">
                <tr>
                    <th>Nome</th>
                    <th>Qtd</th>
                    <th>Status</th>
                    <th>Projeto</th>
                    <th>TÃ©cnico</th>
                    <th>IDGEO</th>
                </tr>
            </thead>
            <tbody>
                {% for f in ferramentas %}
                <tr>
                    <td>{{ f[0] }}</td>
                    <td>{{ f[1] }}</td>
                    <td>{{ f[2] }}</td>
                    <td>{{ f[3] or '-' }}</td>
                    <td>{{ f[4] or '-' }}</td>
                    <td>{{ f[5] or '-' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <form method="get" action="/exportar_excel" class="mt-3">
    <input type="hidden" name="ferramenta" value="{{ request.args.get('ferramenta', '') }}">
    <input type="hidden" name="tecnico" value="{{ request.args.get('tecnico', '') }}">
    <input type="hidden" name="projeto" value="{{ request.args.get('projeto', '') }}">
    <button type="submit" class="btn btn-outline-primary">ðŸ”½ Exportar filtro atual para Excel</button>
</form>

        {% elif request.method == 'POST' %}
            <div class="alert alert-warning">Nenhum resultado encontrado.</div>
        {% endif %}
    </div>
</body>
</html>



